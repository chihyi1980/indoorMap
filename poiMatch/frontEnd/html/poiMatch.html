<div class="navbar navbar-default" id="nav" style="margin: 0; text-align: center">
    <table>
        <tr class="row">
            <td class="navbar-brand" style="background-color: #93A0BC; width: 300px;height: 55px; color: #2e2e2e"><span class="">Atlas Mall</span></td>
            <td class="rightSlider">
                <!--
                <a href="http://ap.atlasyun.com/weixin/MapReborn/indoorMap.html?{{mall._id}}&{{buildings[0]._id}}&" target="_blank">
                    <button type="button" class="btn btn-default pull-left active" ng-show="!!mapFloor">
                        {{mapFloor.displayName}}<span class="badge" style="color: #7a43b6">demo</span>
                    </button>
                </a>
                -->
                <a target="_blank">
                    <button type="button" onclick="(function(){$('#demoModalDiv').addClass('openAttr');$('#demoIframe').attr('src', $('#demoIframe').attr('mySrc'));})()" class="btn btn-default pull-left active"
                            ng-show="!!mapFloor">
                        {{mapFloor.displayName}}<span class="badge" style="color: #7a43b6">demo</span>
                    </button>
                    <div id="demoModalDiv">
                        <div class="content" >
                            <span onclick="(function(){prompt('链接地址','http://' + document.domain + $('#demoIframe').attr('mySrc'));})()"
                                style="width: 50px;font-size: 12px;color: #0000ff;height:20px;cursor: pointer;position: absolute;top: 0;left: 10px;text-decoration: underline ">
                                查看链接</span>
                            <span class="glyphicon glyphicon-remove-circle closeModel" onclick="(function(){$('#demoModalDiv').removeClass('openAttr');})()"></span>
                            <div style="width: 100%;height: 100%; border: dashed 1px #b2dba1">
                                <iframe  id="demoIframe" mySrc="{{base_url}}/MapReborn/indoorMap.html?{{mall._id}}&{{buildings[0]._id}}&" style="width: 100%;height: 100%;">

                                </iframe>
                            </div>
                        </div>
                    </div>
                </a>
                <a ng-show="!isPathDraw && !isFenceDraw && !!mapFloor">
                    <button type="button" class="btn btn-success pull-left" title="保存"  ng-click="saveMapPoi(mapFloor)">
                        <span class="glyphicon glyphicon-floppy-save"></span>
                    </button>
                </a>
                <a ng-show="!!isPathDraw &&!!mapFloor">
                    <button type="button" class="btn btn-primary pull-left" title="保存路径" ng-disabled="!isToDraw && !isPathEdit"  ng-click="savePath(mapFloor)">
                        <span class="glyphicon glyphicon-floppy-save"></span>
                    </button>
                </a>
                <a ng-show="!!isFenceDraw &&!!mapFloor">
                    <button type="button" class="btn btn-warning pull-left" title="保存围栏"   ng-click="saveFence(mapFloor)">
                        <span class="glyphicon glyphicon-floppy-save"></span>
                    </button>
                </a>
                <a>
                    <button type="button" class="btn btn-info pull-left" title="刷新地图数据" ng-disabled="!!isPathDraw || !!isFenceDraw" ng-show="!!mapFloor" ng-click="loadFloorMap(mapFloor)">
                        <span class="glyphicon glyphicon-refresh"></span>
                    </button>
                </a>
                <!--
                <button type="button" class="btn btn-danger pull-right" style="margin: 10px" title="下载svg文件" ng-click="svgExport()" ng-show="!!mapFloor">
                    <span class="glyphicon glyphicon-download"> SVG文件</span>
                </button>
                -->
                <!-- 路径绘制 -->
                <a ng-show="!!mapFloor">
                    <button type="button" class="btn btn-primary pull-left" title="开启绘制路径" ng-disabled='!!isFenceDraw'ng-show="!isPathDraw" ng-click="openPathDraw()">
                        <span class="glyphicon glyphicon-random"></span>
                    </button>
                    <button type="button" class="btn btn-default pull-left active" title="关闭绘制路径" ng-show="!!isPathDraw" ng-click="closePathDraw()">
                        <span class="glyphicon glyphicon-random"></span>
                    </button>
                    <a ng-show="!!isPathDraw">
                        <button type="button" class="btn btn-warning pull-left" title="开始绘制" ng-show="!isToDraw" ng-click="pathBeginDraw()">
                            <span class="glyphicon glyphicon-pencil"></span>
                        </button>
                        <button type="button" class="btn btn-default pull-left active" title="结束绘制"  ng-show="!!isToDraw" ng-click="pathEndDraw()">
                            <span class="glyphicon glyphicon-pencil"></span>
                        </button>
                        <button type="button" class="btn btn-my1 pull-left" title="编辑路径" ng-show="!isPathEdit" ng-click="pathBeginEdit()">
                            <span class="glyphicon glyphicon-edit"></span>
                        </button>
                        <button type="button" class="btn btn-default pull-left active" title="结束编辑"  ng-show="!!isPathEdit" ng-click="pathEndEdit()">
                            <span class="glyphicon glyphicon-edit"></span>
                        </button>
                        <button type="button" class="btn btn-my1 pull-left" title="清除路径" ng-show="!!isPathEdit" ng-click="pathClear()">
                            <span class="glyphicon glyphicon-trash"></span>
                        </button>
                    </a>
                </a>

                <a ng-show="!!mapFloor && !isPathDraw">
                    <button type="button"  class="btn btn-warning pull-left" ng-show="!isFenceDraw" title="开启围栏绘制"  ng-click="openFenceDraw()"
                            style="padding: 0; width: 38px;height: 33px;">
                        <span style="width: 38px;height: 32px;display: inline-block;background-position:center;background-repeat: no-repeat;background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAB5klEQVRYR+1X0VHCQBB9rwLtQDvQDowd2IHYAR0YKtAOhA4sATrADrADqGCdl9lj1hDIBQPxg51hMnMke+923+2+JQY2Drw/WgGYWQGgJKlntpnZ3L/Tc6/tBWBmIwDPAK4B3AJYygvJRzN7B3BX8/pFcuwbG4B7ACsAawAzktMmFIcAaFP95Ehgxg5gbmZaE7Boa5JLj5jWBVKbCviKpMDsWE4KqgjIeXb8AThIbawI5KXAwz4XWj/JQ5dND7y7IKnIKaJFTMevCETimFkJ4LUnABOSZROhtwD8zzfP28xzLgCbRMAjwIgrVwAmzgmRuuITyUXFqeTUT5+Yq5eePAIKX6crWPOpNArApx+uulHJZ04KegHQmgKh3sOB8wGIOQ4k7A1Aax3wCjf1gpJuQW8AvDaMVDETmAsHLhGoR6DqYIOR8D9cw62KOUUdONiMBq+EXoYls6RcXk7UjD6SvJO0q3dDdbwkoySlVK3UjqVoOqmhwKUk3VI7VpdN7bgSqzl14AgZsPNJuyBxDghdlGRH6YAGxPLZLsmajmpm5xOltTog5XLTIMsX3tUktaJtgizXXBBl+XdnWe4KWSmpDyaFt20RLJpkVhpMtB4HE1XXboNJ0HXDjGZ9UD/HR+tklOPkL+/8AKEGpjD1EcXMAAAAAElFTkSuQmCC)"></span>
                     </button>

                    <button type="button" class="btn btn-default pull-left active" ng-show="!!isFenceDraw" title="关闭围栏绘制"   ng-click="closeFenceDraw()"
                            style="padding: 0; width: 38px;height: 33px;">
                        <span style="width: 38px;height: 32px;display: inline-block;background-position:center;background-repeat: no-repeat;background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACN0lEQVRYR+2XMXabQBCG/0FQmxtENzA3sFxIdW5gnJjUukHkE4Tacp7wDVLLhdENyA2UG8i1MJM3A0Kgh4z2BZsU3pZl9tuZf3f+JfQ8qOf10Q7wOB+BMcMkGBnBLucxCDOMg/i1/44DLH/6IL4CswuiIYBEA41vLrG8D0E4rwVm/MbkZgpdmBiAB+Y1iDZgesDka9QEchzgaTFEmsrCHpgEZpoDBDGWdx6I3DoAbzD5lkAyJoMpBLEsmsC217i8XpsB7GY/LVxst0MNbjIE0nFk4c3pJZC0O1astLoT68JkzeNzs5VmTrK6zUbVctRLUBXO43wG0PduAPgW42CmmzoQ9B4g//gDoAjO4AFpOs0B+BlcCNCUhuABdAbwLWw7xPblCmAfGEwx+bKScHuAfPciuDWQ+SD6rADMK+MjuAPNT8SFAjD/AqwIxEPdUHGs20vQFUBrCYS6SQPvClCt8U6EXQI0aOigBPchkEXFhZKfgi4B5G6A5euNWYwPDXxk4D8TYf/HsOJi3uIeeLUZ9X4T5o3jXG0U+PptmhEtSnsn1q7WDTU9hY2y7WjfjiGOxswN7bXkAXDLdpymfmnvCrPafg+YeoDG+acYEtXAoSWDmRU/DhufZsmaAryrKa0CqIHkT0DmlTZKvouV0q5mn9V50+fSlvOAgZdQ7R2sBA79MbflUg6xZiC3tFEKEIz0YQIWgVUGJeXDJJd3Ye94o1bM+GGyC93b06wT9bcHaX+ctsf4pxl/Ac6v0DBSdhvQAAAAAElFTkSuQmCC)"></span>
                    </button>
                    <a ng-show="!!isFenceDraw">
                        <button type="button" class="btn btn-my1 pull-left" title="开始绘制" ng-show="!isToDrawFence" ng-click="fenceBeginDraw()">
                            <span class="glyphicon glyphicon-pencil"></span>
                        </button>
                        <button type="button" class="btn btn-default pull-left active" title="结束绘制"  ng-show="!!isToDrawFence" ng-click="fenceEndDraw()">
                            <span class="glyphicon glyphicon-pencil"></span>
                        </button>
                        <button type="button" class="btn btn-my1 pull-left" title="编辑" ng-show="!isFenceEdit" ng-click="fenceBeginEdit()">
                            <span class="glyphicon glyphicon-edit"></span>
                        </button>
                        <button type="button" class="btn btn-default pull-left active" title="结束编辑"  ng-show="!!isFenceEdit" ng-click="fenceEndEdit()">
                            <span class="glyphicon glyphicon-edit"></span>
                        </button>
                    </a>
                </a>

                <a ng-show="!!mapFloor" ng-href="{{base_url}}/svgEditor/?pid={{mapFloor._id}}" target="_blank">
                    <button type="button" class="btn btn-danger pull-right" title="地图编辑">
                        <span class="glyphicon glyphicon-edit">地图编辑</span>
                    </button>
                </a>

                <a ng-show="!!mapFloor" ng-href="{{base_url}}/geoMatching/" ng-click="setLocalFloorId(mapFloor._id)" target="_blank">
                    <button type="button" class="btn btn-info pull-right" title="大地图配准">
                        <span class="glyphicon glyphicon-edit">大地图配准</span>
                    </button>
                </a>
                <div ng-show="!!mapFloor">
                    <button type="button" class="btn btn-info pull-right active" onclick="(function(){$('#exportModalDiv').addClass('openAttr')})()" title="导出图片">
                        <span class="glyphicon glyphicon-export">导出图片</span>
                    </button>
                    <div id="exportDiv" ng-show="false"></div>
                    <div id="exportModalDiv">
                        <div class="content" >
                            <span class="glyphicon glyphicon-remove-circle closeModel" onclick="(function(){$('#exportModalDiv').removeClass('openAttr');})()"></span>
                            <form>
                                <div style="height: 40px;">
                                    <div class="form-group form-inline" ng-show="!!geoScale">
                                        <div class="col-lg-12 text-right" style="font-size: 12px">原尺寸比例(1单位米的像素值):</div>
                                        <div class="col-lg-12 text-center" style="font-size: 14px;color: #0000ff">x: {{geoScale.x}}, y: {{geoScale.y}}</div>
                                        <hr>
                                    </div>
                                </div>
                                <div class="form-group form-inline" ng-init="_fontsizes=[12,14,16,18,20,22,24,26,28,30]">
                                    <div class="col-lg-6 text-right"><label>字体大小</label></div>
                                    <select ng-model="exportFontsize"  ng-options="(item + 'px') for item in _fontsizes">
                                    </select>
                                </div>
                                <div class="form-group form-inline"  ng-init="_imgsizes=['原尺寸', '1/4', '1/3 ', '1/2', '2', '3', '4']">
                                    <div class="col-lg-6 text-right"><label>图片尺寸</label></div>
                                    <select   ng-model="exportImgsize"  ng-options="(item !== '原尺寸'? item + '×原尺寸': item) for item in _imgsizes"> </select>
                                </div>
                                <div class="form-group form-inline">
                                    <div class="col-lg-6 text-right"><label>是否显示比例</label></div>
                                    <input type="checkbox" ng-model="isShowImgScale" />
                                </div>
                                <button type="button" id="exportDownloadBtn" class="btn btn-success" ng-click="exportFloorImg(mapFloor)">
                                    <span class="glyphicon glyphicon-download"></span>download</button>
                            </form>
                        </div>
                    </div>
                </div>
                <div ng-show="!!mapFloor">
                    <button type="button" class="btn btn-info pull-right active" onclick="(function(){$('#uploadModalDiv').addClass('openAttr')})()" title="导出图片">
                        <span class="glyphicon glyphicon-cog">配置底图</span>
                    </button>
                    <div id="uploadModalDiv">
                        <div class="content" >
                            <span class="glyphicon glyphicon-remove-circle closeModel" onclick="(function(){$('#uploadModalDiv').removeClass('openAttr');})()"></span>
                            <div style="margin-top: 50px">
                                <button type="button" class="btn btn-info active" ng-click="pickImgFile()">
                                <span class="glyphicon glyphicon-upload">
                                    添加图片
                                </span>
                                </button>
                                <button type="button" class="btn btn-danger active" ng-click="removeImgFile()">
                                    <span class="glyphicon glyphicon-remove">
                                        删除图片
                                    </span>
                                </button>
                            </div>
                            <span class="label label-info upfile-msg" ng-show="!!uploadImgMsg">{{uploadImgMsg}}</span>
                            <input type="file" ng-file-select  id="img-sel" style="height:0;width:0;FILTER:alpha(opacity=0);moz-opacity:0;opacity:0;"/>
                            <span class="glyphicon glyphicon-file upfile-name" ng-show="imgfile">：{{imgfile.name}}</span>
                        </div>
                    </div>
                </div>
                <a ng-show="!!mapFloor" ng-href="/weixin/checkSid.html?fid={{mapFloor._id}}" target="_blank">
                    <span class="">sidCheckLink</span>
                </a>
                <a ng-show="!!isMallList">
                    <div class="pull-right">
                        <span class="glyphicon glyphicon-user text-info">hello!&nbsp;</span>
                        <span class="glyphicon glyphicon-off text-primary" style="cursor: pointer" ng-click="logout()">logout</span>
                    </div>
                </a>

            </td>
        </tr>
    </table>
</div>
<div class="container-fluid" id="main" style="overflow: hidden">
    <table>
        <tr class="row">
            <td  class="navbar-brand" style="width: 300px;padding: 0;">
                <div class="sidebar">
                    <div class="head-title" style="position: relative">
                        <span style="padding-left: 10px; font-size: 18px;color: #4cae4c">
                            <span ng-show="!mallCities || !isMallList" class="glyphicon glyphicon-search"></span>
                            <select ng-show="!!mallCities && !!isMallList"  ng-model="selectedCity" ng-options='item for item in mallCities' ng-change='selectCity(selectedCity)' class="city-select">
                            </select>
                        </span>
                        <span class="search-bar">
                            <input type="text" ng-model="mallQuery" class="form-control" ng-show="isMallList" placeholder="输入mall名称">
                            <input type="text" ng-model="shopQuery" class="form-control" ng-show="!isMallList" placeholder="输入shop名称">
                        </span>
                        <button title="新建商场" class="btn btn-danger" style="position: absolute;right: 0; top: 5px;" ng-show="isMallList" ng-click="addMall()">
                            <span class="glyphicon glyphicon-plus-sign"></span>
                        </button>
                    </div>
                    <div class="search-content" ng-show="isMallList && true">
                        <ul class="row" ng-repeat="mall in malls | filter:{ch_name:mallQuery}">
                            <li class="col-md-1">
                                <span class="col-xs-10" title="{{mall.ch_name}}">{{mall.ch_name}}</span>
                                    <span class="col-xs-2 setting-btn" ng-click="showMall(mall)" >
                                        <span class="glyphicon glyphicon-chevron-right"></span>
                                    </span>
                            </li>
                        </ul>
                    </div>
                    <div class="search-content-2" ng-show="!isMallList && true">
                        <span class="glyphicon glyphicon-remove shutdown" id='toggleToMall' ng-show="!(isToolShow || isFacShow)" ng-click="shutDownDetail()" title="关闭"></span>
                        <span class="glyphicon glyphicon-remove-circle shutdown" style="color: #0044cc; font-size: 20px" ng-show="isToolShow || isFacShow" ng-click="closePub()" title="关闭"></span>
                        <div class="s-con-title" title="" ng-mousedown="mallSet($event, mall)">
                            商场：{{mall.ch_name}}
                        </div>
                        <div class="s-con-body" ng-show="!isFacShow && !isToolShow">
                            <div  ng-repeat="building in buildings">
                                <div class="c-rank-1" ng-init="floors = getFloors(building); bIndex = 'building' + $index"
                                     ng-click="toggleChild($event.target, bIndex, building)"
                                     ng-class="getStatus(bIndex) ? 'menu-active' :''"  ng-mousedown="buildingSet($event, building)">
                                    <span class="glyphicon glyphicon-plus pre-btn" ng-show="!getStatus(bIndex)"></span>
                                    <span class="glyphicon glyphicon-minus pre-btn" ng-show="getStatus(bIndex)"></span>
                                    <span class="c-rank-n" >建筑：{{building.ch_name}}</span>
                                    <span class="glyphicon glyphicon-cloud-upload" id="b-set" ng-click="showUpAttr(building, floors)"></span>
                                </div>
                                <div class="floorDiv" ng-repeat="floor in floors"  ng-show="getStatus(bIndex) || isFloorsShow">
                                    <div class="c-rank-2" ng-init="shops = getShops(floor); fIndex = 'floor' + $index"
                                         ng-click="toggleChild($event.target, fIndex, floor)"
                                         ng-class="getStatus(fIndex) ? 'menu-active' :''"
                                         ng-mousedown="floorSet($event, floor)">
                                        <span class="glyphicon glyphicon-plus pre-btn" ng-show="!getStatus(fIndex)"></span>
                                        <span class="glyphicon glyphicon-minus pre-btn" ng-show="getStatus(fIndex)"></span>
                                        <span class="c-rank-n">{{floor.ch_name}}</span>
                                    </div>
                                    <div class="c-rank-3" ng-repeat="shop in shops | shopFilter:shopQuery"
                                         ng-click="shopDrag($event, shop)" ng-show="getStatus(fIndex)" ng-class="isShopMatched(shop) ? 'matched' : ''"
                                         ng-mousedown="shopSet($event, shop)" ng-mouseover="tagToPoi($event, shop, 'shop')">
                                        <span class="c-shop-n">{{$index+1}}.</span>
                                        <span class="c-rank-n">{{shop.en_name || shop.ch_name}}</span>
                                        <span ng-show="isShopMatched(shop)" class="glyphicon glyphicon-ok"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="s-con-body-2" ng-show="isFacShow">
                            <h5><span class="glyphicon glyphicon-th"><small>&nbsp;</small>公共设施</span>
                            </h5>
                            <div class="pub-icon-show">
                                    <span  ng-repeat="fac in facs | orderBy:fac.type| filter:{id: '!13'}" ng-click="facDrag($event, fac)"
                                           title="{{fac.displayName}}" class="{{fac.class}}">
                                    </span>
                            </div>
                            <hr>
                            <h5><span class="glyphicon glyphicon-pencil"><small>&nbsp;</small>文本</span>
                            </h5>
                            <div class="tool-show">
                                <div class="toolbar">
                                    <span class="glyphicon glyphicon-edit" ng-click="editText()" title="编辑"></span>
                                    <span class="glyphicon glyphicon-floppy-disk" ng-show="!isTextSave" ng-click="toggleSaveStatus()" title="保存"></span>
                                    <span class="glyphicon glyphicon-floppy-saved" ng-show="isTextSave" ng-click="toggleSaveStatus()" title="已保存"></span>
                                    <span class="glyphicon glyphicon-remove-sign" ng-show="!isTextShow" ng-click="clearText()" title="删除"></span>
                                </div>
                                <div style="padding:10px">
                                    <textarea ng-model="mapText" ng-show="!isTextShow && !isTextSave" placeholder="输入后，保存"></textarea>
                                    <pre ng-show="isTextSave" ng-click="textDrag($event, {'text':mapText})">{{mapText}}</pre>
                                </div>
                            </div>
                        </div>
                        <div class="s-con-body-3" ng-show="isToolShow">
                            <h5 class="beacon-title">
                                <span class="glyphicon glyphicon-bold"><small>&nbsp;</small>
                                    iBeacon --- {{curMapFloor.displayName}}({{curMapFloor.ch_name}})
                                </span>
                                <button title="新建beacon" class="btn btn-info pull-right" ng-click="showBeaconAttr('add')">
                                    <span class="glyphicon glyphicon-plus-sign"></span>
                                </button>
                            </h5>
                            <div class="c-rank-3" ng-repeat="beacon in curFloorBeacons"
                                 ng-click="beaconDrag($event, beacon)"  ng-class="!!beacon.matched ? 'matched' : ''"
                                 ng-mousedown="beaconSet($event, beacon)"
                                 ng-mouseover="tagToPoi($event, beacon, 'beacon')">
                                <span class="c-shop-n">{{$index+1}}.</span>
                                <span class="c-rank-n">{{beacon.name}}<i style="opacity: 0.5">（{{beacon.mac}}）</i></span>
                                <span ng-show="!!beacon.matched" class="glyphicon glyphicon-ok"></span>
                            </div>
                            <!--
                            <div class="tool-show">
                               <div class="speech-outer" ng-click="beaconDrag($event)"><span class="speech"><span class="glyphicon glyphicon-bold"></span></span></div>
                            </div>-->
                        </div>

                        <div class="c-con-pub">
                            <button class="btn btn-info" type="button" ng-click="getFacilities()">
                                <span class="glyphicon glyphicon-th">公共设施</span>
                            </button>&nbsp;&nbsp;&nbsp;
                            <button class="btn btn-warning" type="button" ng-show="curMapFloor" ng-click="getTools()">
                                <span class="glyphicon glyphicon-screenshot">beacon</span>
                            </button>
                        </div>
                    </div>

                    <div class="footer"></div>
                </div>
            </td>
            <td class="rightSlider">
                <div ng-show="!!isFenceEdit" style="line-height:40px;background: #FFF;position: absolute;z-index:1000; width: 400px; height: 40px;box-shadow: 1px 0 2px rgba(100,100,100, 0.7);oxmargin-top: 10px; top: 60px; right: 5px;">
                    <form class="form-inline">
                        <div class="form-group col-lg-6">
                            <label for="fenceId-set">id</label>
                            <input type="text" style="width: 140px" class="form-control" id="fenceId-set" ng-disabled="!curSelFenceId" placeholder="id">
                        </div>
                        <div class="form-group  col-lg-6" style="padding-left: 0 ">
                            <label for="fenceName-set">name</label>
                            <input type="text"  style="width: 140px" class="form-control" id="fenceName-set" ng-disabled="!curSelFenceId"  placeholder="name">
                        </div>
                    </form>
                    <!--<input type="text" id="fenceId-set" ng-disabled="!curSelFenceId" style="color: #1F52F7;font-weight: bold;text-align: center" class="form-control"  />-->
                </div>
                <div class="map-display" ng-click="dropFunc($event)" ng-style="{width:getMapShowWidth()}">
                    <div id="atlas" ng-show="isMapShow">

                    </div>
                    <div class="container" ng-show="!isMapShow">
                        <div class="jumbotron">
                            <h2 style="text-align: center;">使用帮助</h2>
                            <p class="lead"><span class="label label-warning">1</span>
                                搜索到商场后，
                                点击<span class="label label-info"><span class="glyphicon glyphicon-chevron-right" style="font-size: 12px;"></span></span>
                                进入操作;
                            </p>
                            <p class="lead">
                                <span class="label label-success">2</span>
                                点击<span class="label label-danger"><span class="glyphicon glyphicon-cloud-upload" style="font-size: 12px;"></span></span>
                                -- <span class="label label-info"><span class="glyphicon glyphicon-upload"> 添加文件</span></span>
                                上传地图数据；
                            </p>
                            <p class="lead">
                                <span class="label label-info">3</span>
                                点击<span class="label label-primary"><span class="glyphicon glyphicon-refresh"></span></span> 加载或刷新地图最新数据，
                                点击楼层菜单可加载该楼层地图；
                            </p>
                            <p class="lead">
                                <span class="label label-primary">4</span>
                                搜索商铺或点击菜单展开商铺，点击商铺，拖动鼠标至右侧地图，再次点击即可；
                            </p>
                            <p class="lead">
                                <span class="label label-danger">5</span>
                                点击左下侧 <span class="label label-info"><span class="glyphicon glyphicon-th">公共设施</span></span>或
                                <span class="label label-warning"><span class="glyphicon glyphicon-screenshot">beacon</span></span>，
                                为地图添加公共设施、文字或beacon。
                            </p>
                        </div>
                        <footer>
                            <p style="text-align: center;">&copy; Atlas 2014</p>
                        </footer>
                    </div>

                </div>
            </td>
        </tr>
    </table>
</div>
<!--models for upload configFile -->
<div id="attrDiv">
    <div class="content" >
        <table>
            <tr>
                <td style="height: 40px;line-height:40px">
                    {{destBuilding.ch_name}}
                    <span class="glyphicon glyphicon-remove-circle closeModel" ng-click="closeAttrDiv()"></span>
                </td>
            </tr>
            <tr>
                <td>
                    <button type="button" class="btn btn-info active" ng-click="pickFile()">
                            <span class="glyphicon glyphicon-upload">
                                添加文件
                            </span>
                    </button>
                    <input type="file" ng-file-select ng-model="configFile" id="file-sel" style="height:0;width:0;FILTER:alpha(opacity=0);moz-opacity:0;opacity:0;"/>
                    <span class="glyphicon glyphicon-file upfile-name" ng-show="file">：{{file.name}}</span>
                </td>
            </tr>
            <tr>
                <td>
                    <span class="label label-danger upfile-msg" ng-show="!!uploadMsg">{{uploadMsg}}</span>
                </td>
            </tr>
        </table>
    </div>
</div>
<!-- right click menu-->
<div id="poiDiv">
    <div class="content">
        <div class="poi-title">
            <span ng-show="opType == 'edit'">编辑</span>
            <span ng-show="opType == 'add'">添加</span>
            <span class="poi-name">{{poiType}}({{currentPoiName}})</span>
            <span ng-show="opType == 'edit'"> &nbsp; id: <input type="text" style="width: 260px" value="{{currentPoi._id}}"></span>
            <span class="glyphicon glyphicon-remove-circle closeModel" ng-click="closePoiDiv()"></span>
        </div>
        <form class="form-horizontal" name="poiForm" ng-submit="savePoi()" role="form">
            <div ng-show="poiType == 'shop'">
                <div class="col-lg-2"><h4 style="text-align: right">分类</h4></div>
                <div class="col-lg-10">
                    <ul class="list-inline" >
                        <li ng-repeat="prod in prods" class="col-lg-1" style="cursor: pointer" title="{{prod.replace('atlas-','')}}">
                            <input type="radio" name="shopProd" ng-model="currentPoi['prodId']" value="{{$index}}" />
                            <span class="atlas {{prod}}" style="font-size: 24px;"></span>
                        </li>
                    </ul>
                </div>
            </div><br />
            <div id="aliasModalDiv" ng-show="is_aliases && true" >
                <div class="content" style="padding: 10px !important;" >
                    <span class="glyphicon glyphicon-remove-circle closeModel" onclick="(function(){$('#aliasModalDiv').removeClass('openAttr');})()"></span>
                    <div style="height: 10px;"></div>
                    <div style=" padding: 5px 20px; overflow:hidden;text-align: center;font-size: 14px;">
                        <b>{{currentPoi.ch_name}}</b>: <b class="text-primary">{{currentPoi.brand_id}}</b>
                    </div>
                    <span>{{aliases.remaining()}} / {{aliases.todos.length}}</span>
                    [ <a href="" ng-click="aliases.archive()">清除</a> ]
                    <ul class="unstyled" style="text-align: left;font-size: 14px;">
                        <li ng-repeat="todo in aliases.todos">
                            <label class="checkbox">
                                <input type="checkbox" ng-model="todo.done">
                                <span class="done-{{todo.done}}">{{todo.text}}</span>
                            </label>
                        </li>
                    </ul>
                    <div>
                        <input type="text" ng-model="aliases.todoText"  size="30" style="padding: 0 5px; text-align: center"
                               placeholder="add alias" value="{{currentPoi.ch_name}}">
                        <input class="btn-primary" type="button" ng-click="aliases.addTodo()" value="add">
                    </div>
                    <div style="padding: 10px;">
                        <input class="btn btn-success" type="button" ng-click="aliases.save(currentPoi.brand_id)" value="save">
                    </div>
                </div>
            </div>
            <table>
                <tr ng-show="opType == 'edit' && poiType == 'shop'" >
                    <td><small class="text-primary" style="font-size: 10px" >(大小限制500KB）</small>Logo</td>
                    <td>
                        <button  type="button" class="btn btn-success pull-left" ng-click="pickupImg()"><span class="glyphicon glyphicon-cloud"></span> 上传</button>
                        <span style="width: 80px;height: 50px; line-height:50px;display: inline-block" class="text-info pull-left"><b id='logoUpMsg'>{{logoUploadMsg}}</b></span>
                        <a ng-show="curShoplogoUrl"  href="{{curShoplogoUrl}}" target="_blank">
                            <img ng-src="{{curShoplogoUrl}}"  class="img-thumbnail" style="height: 50px; width: 80px;" alt="Responsive image">
                        </a>
                        <span ng-show="curShoplogoUrl" ng-click='reomveShopLogo(currentPoi._id)' class="text-primary glyphicon glyphicon-remove" style="cursor: pointer;margin-left: 10px;font-size: 20px" title="删除"></span>
                        <div style="position:absolute;top:340px;left:298px;width:130px;height:35px;overflow:hidden;z-index:0;">
                            <input name="userfile[]"  multiple="multiple" id="logoToUpload"  ng-file-select type="file" style="FILTER:alpha(opacity=0);moz-opacity:0;opacity:0;width:100px"/>
                        </div>
                    </td>
                </tr>
                <tr ng-repeat="attr in poiAttrs | filter:{type:'text'}">
                    <td><b class="text-danger" ng-show="{{attr.attr == 'ch_name' || attr.attr == 'en_name' || attr.attr == 'displayName' ? true: false}}">* 必填</b>
                        &nbsp;{{attr.tip}}:
                    </td>
                    <td style="position: relative; height: 40px !important;">
                            <input type="{{attr.type}}" class="form-control formInput" name="{{attr.attr}}" ng-model="currentPoi[attr.attr]" placeholder="{{attr.attr}}{{attr.desc && ('，' + attr.desc)}}"
                                   ng-required="{{attr.attr == 'ch_name' || attr.attr == 'en_name' || attr.attr == 'displayName' ? true: false}}"
                                   ng-auto-complete="{{poiType == 'shop' && (attr.attr == 'en_name'||attr.attr == 'ch_name')}}">

                            <span  ng-show="{{attr.attr == 'brand_id' && is_aliases}}"  style="width: 100px;height: 40px; position: absolute; top:2px;right:-1px;cursor: pointer;">
                                <button ng-disabled='!currentPoi.brand_id || currentPoi.brand_id.length !== 24'ng-click="openAliases();" type="button" style="margin: 0;" class="btn btn-danger">
                                    <sapn class="glyphicon glyphicon-plus">新增别名</sapn>
                                </button>
                            </span>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>

                    </td>
                    <td>
                        <button type="submit" id="saveBtn" ng-disabled="poiForm.$invalid" class="btn btn-primary">保存</button>
                        <button type="button" id="cancelBtn" ng-click="closePoiDiv()" class="btn btn-default">取消</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>
<div id="beaconDiv">
    <div class="content">
        <div class="poi-title">
            <span ng-show="!!isBeaconEdit">编辑</span>
            <span ng-show="!isBeaconEdit">添加beacon</span>
            <span class="poi-name">({{curMapFloor.ch_name}})</span>
            <span class="glyphicon glyphicon-remove-circle closeModel" ng-click="closeBeaconAttr()"></span>
        </div>
        <form class="form-horizontal" name="beaconForm" ng-submit="saveBeacon()" role="form">
            <table>
                <tr>
                    <td>name:</td>
                    <td>
                        <input type="text" class="form-control formInput" ng-model="curBeacon['name']" placeholder="name,必填" required/>
                    </td>
                </tr>
                <tr>
                    <td>mac:</td>
                    <td>
                        <input type="text" class="form-control formInput" ng-model="curBeacon['mac']" placeholder="mac,必填" required/>
                    </td>
                </tr>
                <tr>
                    <td>uuid:</td>
                    <td>
                        <input type="text" class="form-control formInput" ng-model="curBeacon['uuid']" placeholder="uuid" />
                    </td>
                </tr>
                <tr>
                    <td>major:</td>
                    <td>
                        <input type="text" class="form-control formInput" ng-model="curBeacon['major']" placeholder="major" />
                    </td>
                </tr>
                <tr>
                    <td>minor:</td>
                    <td>
                        <input type="text" class="form-control formInput" ng-model="curBeacon['minor']" placeholder="minor" />
                    </td>
                </tr>
                <tr>
                    <td>wifiId:</td>
                    <td>
                        <input type="text" class="form-control formInput" ng-model="curBeacon['wifiId']" placeholder="wifiId" />
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>

                    </td>
                    <td>
                        <button type="submit" ng-disabled="beaconForm.$invalid" class="btn btn-primary">保存</button>
                        <button type="button"  ng-click="closeBeaconAttr()" class="btn btn-default">取消</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>

<div id="beaconScanDiv">
    <div class="content">
        <div class="poi-title">
            <span >扫描 定位数据</span>
            <span class="poi-name">({{curMapFloor.ch_name}})</span>
            <span class="glyphicon glyphicon-remove-circle closeModel" ng-click="closeBeaconScanAttr()"></span>
        </div>
        <form class="form-horizontal" name="beaconScanForm" ng-submit="startScanBeacon()" role="form">
            <table>
                <tr>
                    <td>新增扫描数据 :</td>
                    <td>
                        <input type="text" class="form-control formInput" ng-model="curBeacon['scanAddNum']" required/>
                    </td>
                </tr>
                <tr>
                    <td>目前扫描数据:</td>
                    <td>
                        <span ng-bind="curBeacon['scanData'].length" ></span>
                    </td>
                </tr>
                <tr>
                    <td>状态:</td>
                    <td>
                        <span ng-bind="curBeacon['scanStatus']"></span>
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>

                    </td>
                    <td>
                        <button type="submit" ng-disabled="beaconForm.$invalid || curBeacon.scanStatus == 'SCANNING' " class="btn btn-primary">开始</button>
                        <button type="button"  ng-click="stopScanBeacon()" class="btn btn-default">停止</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>

<div id="anchorDiv">
    <div class="content">
        <div class="poi-title">
            <span class="poi-name">设置楼层锚点</span>
            <span class="glyphicon glyphicon-remove-circle closeModel" ng-click="closeAnchorAttr()"></span>
        </div>
        <form class="form-horizontal" name="beaconForm" ng-submit="saveBeacon()" role="form">
            <table class="table">
                <tr>
                    <td class="col-sm-4" style="border: none">
                        <div id="anchor-source">
                            楼层：{{mapFloor.ch_name}}<br/>
                            名称：{{curAnchor.type == '3'? "扶梯": (curAnchor.type == '1'? "电梯" : "")}}<br/>
                            坐标：{{curAnchor.x}}，{{curAnchor.y}}<br/>
                        </div>
                        <div id="anchor-source-map">

                        </div>
                    </td>
                    <td style="border: none" ng-show="initJoin.down">
                        <div class="anchor-floor">
                            楼层↓：
                            <select  class="anchor-floor-sel" type="down">
                                <option ng-repeat="df in downFloorJoins"  value="{{df}}" ng-selected="initJoin.down._id == df._id" >
                                    {{df.ch_name}}
                                </option>
                            </select>&nbsp;&nbsp;
                            名称：{{curAnchor.type == '3' ? "扶梯": ""}}{{curAnchor.type == '2' ? "楼梯":""}}{{curAnchor.type == '1' ? "电梯" : ""}}<br/>
                            <select class="form-control anchor-matched" floorId="{{initJoin.down._id}}" type="down">
                                <option selected value="">无</option>
                                <option ng-repeat="f in initJoin.down.fac" value="{{f}}" ng-init="isSelected=anchorIsSelected(f, initJoin.down._id)" ng-selected="isSelected" ng-class="isSelected?'active':''">
                                    {{isSelected?'√ ':''}}坐标：{{f.x}}，{{f.y}}
                                </option>
                            </select>
                        </div>
                        <div id="anchor-floor-{{initJoin.down.ch_name}}" class="anchor-floor-map">

                        </div>
                    </td>
                    <td  style="border: none" ng-show="initJoin.up">
                        <div class="anchor-floor">
                            楼层↑：
                            <select class="anchor-floor-sel" type="up">
                                <option ng-repeat="uf in upFloorJoins"  value="{{uf}}" ng-selected="initJoin.up._id == uf._id"  >
                                    {{uf.ch_name}}
                                </option>
                            </select>&nbsp;&nbsp;
                            名称：{{curAnchor.type == '3' ? "扶梯": ""}}{{curAnchor.type == '2' ? "楼梯":""}}{{curAnchor.type == '1' ? "电梯" : ""}}<br/>
                            <select class="form-control anchor-matched" floorId="{{initJoin.up._id}}" type="up">
                                <option selected value="">无</option>
                                <option ng-repeat="f in initJoin.up.fac" value="{{f}}" ng-init="isSelected=anchorIsSelected(f, initJoin.up._id)" ng-selected="isSelected" ng-class="isSelected?'active':''">
                                    {{isSelected?'√ ':''}}坐标：{{f.x}}，{{f.y}}
                                </option>
                            </select>
                        </div>
                        <div id="anchor-floor-{{initJoin.up.ch_name}}" class="anchor-floor-map">

                        </div>
                    </td>
                </tr>
            </table>
            <button type="button" class="btn btn-primary" ng-click="saveAnchor()">确定</button>
        </form>
    </div>
</div>
<div id="mallDiv">
    <div class="content">
        <div class="poi-title">
            <span class="poi-name">新建商场</span>
            <span class="glyphicon glyphicon-remove-circle closeModel" ng-click="closeMallDiv()"></span>
        </div>
        <form class="form-horizontal" name="mallForm" role="form">
            <table>
                <tr ng-repeat="attr in mallAttrs | filter:{type:'text'}">
                    <td>{{attr.tip}}:</td>
                    <td>
                        <input type="text" class="form-control formInput" name="{{attr.attr}}" ng-model="newMall[attr.attr]" placeholder="{{attr.attr}}"
                               ng-required="{{attr.attr == 'ch_name' || attr.attr == 'displayName' ? true: false}}">
                    </td>
                </tr>
                <tr>
                    <td></td>
                    <td></td>
                </tr>
                <tr>
                    <td>

                    </td>
                    <td>
                        <button type="submit"  ng-click="saveMall()" ng-disabled="mallForm.$invalid" class="btn btn-primary">保存</button>
                        <button type="button"  ng-click="closeMallDiv()" class="btn btn-default">取消</button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>
